(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{167:function(t,e,n){"use strict";var i=n(16),o=n.n(i),a=n(21),s=n.n(a),r=n(1),c=n.n(r),l=n(33),u=n(3),d=n(78),h=n.n(d),f=n(75),p=n.n(f),g=n(79),m=n.n(g),b=n(45),v=n.n(b),y=n(332),w=n.n(y),x=n(22),j=n.n(x),k=n(23),_=n.n(k),C=n(7),O=n(31),T=n.n(O),E={waitForImages:!0,waitForLinks:!0,waitForInteractives:!1},S=function(t){return t instanceof HTMLIFrameElement},$=function(t){try{return t.contentWindow&&t.contentWindow.document&&"complete"===t.contentWindow.document.readyState}catch(t){return!0}},I=function(t){window.setTimeout(t,5e3)},L=function(t){return t.bodySelector||"document"},A=T()(function(t){var e=j()("img",t.body).filter(function(t){return!t.complete});return 0===e.length?Promise.resolve():new Promise(function(n){var i=0;_.a.on(t.body,"load",e,function o(){(i+=1)===e.length&&(_.a.off(t.body,"load",o),e.length=0,n())})})},L),M=T()(function(t){return 0===j()(".element-rich-link--not-upgraded",t.body).length?Promise.resolve():new Promise(function(t){C.a.once("rich-link:loaded",t)})},L),P=T()(function(t){var e=j()(".element-interactive",t.body).filter(function(t){var e=Array.from(t.children).filter(S);return!(e.length&&$(e[0]))});return 0!==e.length&&"MutationObserver"in window?Promise.all(e.map(function(t){return new Promise(function(e){new MutationObserver(function(t,n){if(t.length&&t[0].addedNodes.length&&S(t[0].addedNodes[0])){var i=t[0].addedNodes[0];$(i)?(n.disconnect(),e()):i.addEventListener("load",function(){n.disconnect(),e()})}}).observe(t,{childList:!0})})})).then(function(){}):Promise.resolve()},L),B=function(t,e,n){var i=[];return t.forEach(function(t){e(t)?i.push(t):n.push(t)}),i},q=function(t){function e(t){var n;return o()(this,e),n=h()(this,p()(e).call(this)),c()(v()(v()(n)),"name",void 0),c()(v()(v()(n)),"message",void 0),n.name="SpaceError",n.message="There is no space left matching rules from ".concat(t.bodySelector),n}return m()(e,t),e}(w()(Error)),R=function(t){return Object.freeze({top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight,element:t})};n.d(e,"a",function(){return H});var z=function(t){return l.a.captureException(t),!1},H=new(function(){function t(){o()(this,t),c()(this,"queue",void 0),this.queue=Promise.resolve()}return s()(t,[{key:"fillSpace",value:function(t,e,n){var i=function(t){return u.a.write(function(){return e(t)})},o=function(t){if(t instanceof q)return!1;throw t};return this.queue=this.queue.then(function(){return function(t,e,n){t.body=t.bodySelector&&document.querySelector(t.bodySelector)||document;var i=n||{};return function(t,e){return Promise.race([new Promise(I),Promise.all([!e.waitForImages||A(t),!e.waitForLinks||M(t),!e.waitForInteractives||P(t)])]).then(function(){return t})}(t,e||E).then(function(){return function(t,e){var n=j()(t.bodySelector+t.slotSelector);if(t.fromBottom&&n.reverse(),t.startAt){var i=!0;e.startAt=[],n=B(n,function(e){return e===t.startAt&&(i=!1),!i},e.startAt)}if(t.stopAt){var o=!0;e.stopAt=[],n=B(n,function(e){return e===t.stopAt&&(o=!1),o},e.stopAt)}return n}(t,i)}).then(function(e){return function(t,e){var n=t.clearContentMeta?document.querySelector(".js-content-meta"):null,i=t.selectors?Object.keys(t.selectors).map(function(e){return[e,j()(t.bodySelector+e)]}):null;return u.a.read(function(){var o=t.body instanceof Element&&t.body.getBoundingClientRect(),a=e.map(R),s=t.clearContentMeta&&n?R(n):null,r=i?i.reduce(function(t,e){return t[e[0]]=e[1].map(R),t},{}):null;return{bodyTop:o.top||0,bodyHeight:o.height||0,candidates:a,contentMeta:s,opponents:r}})}(t,e)}).then(function(e){return function(t,e,n){var i=t.candidates;return n.absoluteMinAbove=[],i=B(i,function(n){return!e.absoluteMinAbove||n.top+t.bodyTop>=e.absoluteMinAbove},n.absoluteMinAbove),n.aboveAndBelow=[],i=B(i,function(n){var i=n.top>=e.minAbove,o=n.top+e.minBelow<=t.bodyHeight;return i&&o},n.aboveAndBelow),e.clearContentMeta&&(n.contentMeta=[],i=B(i,function(n){return!!t.contentMeta&&n.top>t.contentMeta.bottom+e.clearContentMeta},n.contentMeta)),e.selectors&&Object.keys(e.selectors).forEach(function(o){n[o]=[],i=B(i,function(n){return function(t,e,n){return n.every(function(t,e,n){var i=e.top-n.bottom>=t.minAbove,o=n.top-e.top>=t.minBelow;return i||o}.bind(void 0,t,e))}(e.selectors[o],n,t.opponents?t.opponents[o]:[])},n[o])}),e.filter&&(n.custom=[],i=B(i,e.filter,n.custom)),i}(e,t,i)}).then(function(e){return function(t,e){if(!e.length)throw new q(t);return e.map(function(t){return t.element})}(t,e)})}(t,n).then(i,o)}).catch(z),this.queue}}]),t}())},230:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var i=n(16),o=n.n(i),a=n(21),s=n.n(a),r=n(1),c=n.n(r),l=n(7),u=n(12),d=n.n(u),h=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o()(this,t),c()(this,"element",void 0),c()(this,"opts",void 0),c()(this,"offsetFromParent",void 0),c()(this,"lastMessage",void 0),this.element=e,this.opts=Object.assign({},{top:0,containInParent:!0,emitMessage:!1},n)}return s()(t,[{key:"init",value:function(){var t=this,e=this.element.parentElement;e&&(d.a.read(function(){t.offsetFromParent=t.element.getBoundingClientRect().top-e.getBoundingClientRect().top},this),l.a.on("window:throttledScroll",this.updatePosition.bind(this)),d.a.read(this.updatePosition,this))}},{key:"updatePosition",value:function(){var t=this,e=this.element.parentElement;if(e){var n,i,o,a=this.element.getBoundingClientRect(),s=e.getBoundingClientRect(),r=a.height;if(s.top+this.offsetFromParent>0)o=!1,n={top:""},i="unfixed";else{o=!0;var c=this.opts.containInParent&&s.bottom<=a.height?Math.floor(s.bottom-r-this.opts.top):this.opts.top;n={top:"".concat(c,"px")},i="fixed"}this.opts.emitMessage&&i&&i!==this.lastMessage&&(this.emitMessage(i),this.lastMessage=i),n&&d.a.write(function(){o?t.element.classList.add("is-sticky"):t.element.classList.remove("is-sticky"),Object.assign(t.element.style,n)},this)}}},{key:"emitMessage",value:function(t){l.a.emit("modules:".concat(this.element.id,":").concat(t))}}]),t}()},348:function(t,e,n){"use strict";n.d(e,"a",function(){return k});var i=n(16),o=n.n(i),a=n(78),s=n.n(a),r=n(75),c=n.n(r),l=n(21),u=n.n(l),d=n(79),h=n.n(d),f=n(22),p=n.n(f),g=n(3),m=n(76),b=n(7),v=n(39),y=n.n(v),w=new Promise(function(t,e){b.a.on("modules:onward:geo-most-popular:ready",t),b.a.on("modules:onward:geo-most-popular:cancel",t),b.a.on("modules:onward:geo-most-popular:error",e)}),x=function(t){function e(){var t;return o()(this,e),(t=s()(this,c()(e).call(this))).endpoint="/most-read-geo.json",b.a.emit("register:begin","geo-most-popular"),t}return h()(e,t),u()(e,null,[{key:"error",value:function(t){b.a.emit("modules:onward:geo-most-popular:error",t)}}]),u()(e,[{key:"ready",value:function(){b.a.emit("register:end","geo-most-popular"),b.a.emit("modules:onward:geo-most-popular:ready",this)}}]),e}(m.a),j=function(t){t>1500&&(new x).fetch(p()(".js-components-container"),"rightHtml")},k={render:y()(function(){return g.a.read(function(){var t=document.querySelector(".js-article__body");return t?t.getBoundingClientRect()&&t.getBoundingClientRect().height:0}).then(j),w}),whenRendered:w}},495:function(t,e,n){"use strict";n.r(e);var i,o,a=n(3),s=n(22),r=n.n(s),c=n(8),l=n(0),u=n(157),d=n(491),h=n(520),f=n(26),p=n(511),g=n(16),m=n.n(g),b=n(21),v=n.n(b),y=n(78),w=n.n(y),x=n(75),j=n.n(x),k=n(79),_=n.n(k),C=n(76),O=n(7),T=function(t){function e(){var t;m()(this,e),t=w()(this,j()(e).call(this));var n=l.a.get("page.section"),i=n&&!["info","global"].includes(n);return t.endpoint="/most-read".concat(i?"/".concat(n):"",".json"),O.a.emit("register:begin","popular-in-section"),t.fetch(r()(".js-popular-trails"),"html"),t}return _()(e,t),v()(e,[{key:"ready",value:function(){O.a.emit("modules:popular:loaded"),O.a.emit("register:end","popular-in-section")}}]),e}(C.a),E=n(14),S=n.n(E),$=n(15),I=n(481),L=n(1),A=n.n(L),M=function(){function t(e){m()(this,t),A()(this,"opts",void 0),A()(this,"dom",void 0),A()(this,"cta",void 0),A()(this,"expanded",void 0),A()(this,"showCount",void 0),this.opts=e,this.dom=e.dom,this.expanded=!1!==e.expanded,this.cta=document.createElement("button"),this.showCount=!1!==e.showCount}return v()(t,[{key:"renderState",value:function(){this.expanded?this.dom.classList.remove("shut"):this.dom.classList.add("shut")}},{key:"getCount",value:function(){return parseInt(this.dom.getAttribute("data-count")||"0",10)}},{key:"updateCallToAction",value:function(){var t="Show ".concat(this.showCount?"".concat(this.getCount()," "):"").concat(this.expanded?"fewer":"more");this.cta.innerHTML=t,this.cta.setAttribute("data-link-name","Show ".concat(this.expanded?"more":"fewer")),this.cta.setAttribute("data-is-ajax","1")}},{key:"toggleExpanded",value:function(){this.expanded=!this.expanded,this.renderState(),this.updateCallToAction()}},{key:"isOpen",value:function(){return!this.dom.classList.contains("shut")}},{key:"renderCallToAction",value:function(){var t=this;this.cta.addEventListener("click",function(){t.toggleExpanded()}),this.cta.className="cta",this.opts.buttonAfterEl?this.opts.buttonAfterEl.insertAdjacentElement("afterend",this.cta):this.dom.appendChild(this.cta),this.updateCallToAction()}},{key:"scrollToCallToAction",value:function(){var t=this;this.expanded||window.setTimeout(function(){t.cta.scrollIntoView()},550)}},{key:"init",value:function(){this.dom.classList.contains("expandable-initialised")||!this.dom.innerHTML||this.getCount()<3||(this.dom.classList.add("expandable-initialised"),this.renderCallToAction(),this.renderState())}},{key:"toggle",value:function(){this.toggleExpanded()}}]),t}(),P=n(24),B=function(t){new M({dom:t,expanded:!1,showCount:!1}).init()},q=n(45),R=n.n(q),z={uk:{comment:"uk-alpha/contributors/feature-stories"},us:{comment:"us-alpha/contributors/feature-stories"},au:{comment:"au-alpha/contributors/feature-stories"},int:{comment:"ee3386bb-9430-4a6d-8bca-b99d65790f3b"}},H=function(t){function e(){var t;return m()(this,e),t=w()(this,j()(e).call(this)),A()(R()(R()(t)),"edition",void 0),Object(I.a)("tonal-content"),t.edition=l.a.get("page.edition","").toLowerCase(),t.isSupported()&&(t.endpoint=t.getEndpoint()),t}return _()(e,t),v()(e,null,[{key:"getTone",value:function(){return l.a.get("page.tones","").split(",")[0].toLowerCase()}},{key:"ready",value:function(){O.a.emit("modules:tonal:loaded"),Object(I.b)("tonal-content")}},{key:"error",value:function(){Object(I.c)("tonal-content")}}]),v()(e,[{key:"getEndpoint",value:function(){var t=z[this.edition][e.getTone()];return"/container/".concat(t,".json")}},{key:"isSupported",value:function(){return e.getTone()in z[this.edition]}}]),e}(C.a),U=n(12),F=n.n(U),N=n(13),D=n(496),J=n(59),W=n.n(J),V=n(319),K=n(512),G=n.n(K),Q=n(513),X=n.n(Q),Z=Object(c.a)(".js-sharecount"),Y={facebook:"n/a"},tt=0,et=function(){var t="".concat(l.a.get("page.ajaxUrl"),"/sharecount/").concat(l.a.get("page.pageId"),".json");Object($.a)(t,{mode:"cors"}).then(function(t){var e=t.share_count||0;Y.facebook=e,function(t){var e=Object(V.a)("share"),n=Z.hasClass("js-sharecount-immersive")?X.a:G.a,a=W()(n)({icon:e});Z.removeClass("u-h").html(a).css("display",""),o=Object(c.a)(".sharecount__value--short",Z[0]),i=Object(c.a)(".sharecount__value--full",Z[0]),function(t){if(0!==t){var e=parseInt((tt+=t).toFixed(0),10),n=Object(D.a)(e),a=e>1e4?"".concat(Math.round(e/1e3),"k"):e;F.a.write(function(){i.text(n),o.text(a)})}}(t)}(e),Z.attr("title",W()("Facebook: <%=facebook%>")(Y))})},nt=function(){if(l.a.get("switches.serverShareCounts")&&Z.length&&!l.a.get("page.isPreview"))try{et()}catch(t){Object(N.a)(new Error("Error retrieving share counts (".concat(t.message,")")),{feature:"share-count"},!1)}},it=n(23),ot=n.n(it),at=function(t,e,n,i){var o=new C.a;return o.manipulationType=n,o.endpoint=e+(i?"?page=".concat(i):""),t.innerHTML="",o.fetch(t,"html")},st=n(321);n.d(e,"initTrails",function(){return pt});var rt=function(){var t=l.a.get("page",{}),e=t.showRelatedContent,n=t.isPaidContent,i=t.section,o=t.shortUrl,a=t.seriesId;"Audio"!==l.a.get("page.contentType")&&"Video"!==l.a.get("page.contentType")||!e||n||!i||function(t,e,n,i,o){var a=new C.a,s=o?"/".concat(o):"",r="video"===e?"&exclude-tag=guardian-professional/guardian-professional":"",c="/".concat(e,"/section/").concat(n).concat(s,".json?shortUrl=").concat(i).concat(r);a.endpoint=c,a.fetch(t).then(function(){Object(st.a)([t]),O.a.emit("page:media:moreinloaded",t)})}(Object(c.a)(".js-more-in-section")[0],l.a.get("page.contentType","").toLowerCase(),i,o,a)},ct=function(t,e){window.location.hash?e():a.a.read(function(){return document.querySelector(t)}).then(function(t){t&&Object(d.a)(t,1500,e)})},lt=function(){l.a.get("page.isFront")||ct(".js-popular-trails",function(){new T})},ut=function(){l.a.get("page.seriesId")||l.a.get("page.blogIds")||ct(".js-related",function(){var t={excludeTags:[]};"paid-content"!==l.a.get("page.sponsorshipType")&&t.excludeTags.push("tone/advertisement-features"),"contentType"in l.a.get("page")&&["video","interactive"].includes(l.a.get("page.contentType","").toLowerCase())&&t.excludeTags.push("guardian-professional/guardian-professional"),function(t){var e,n,i,o=P.a.adFree&&l.a.get("page.isPaidContent");if(l.a.get("page.hasStoryPackage")){var s=document.body&&document.body.querySelector(".related-trails");s&&B(s)}else if(l.a.get("switches.relatedContent")&&l.a.get("page.showRelatedContent")&&!o){var r=document.body&&document.body.querySelector(".js-related");if(r&&!r.classList.contains("lazyloaded")){n=function(){if(!l.a.get("page.keywordIds"))return!1;var t,e,n=l.a.get("page.keywordIds","").split(","),i=l.a.get("page.isPaidContent")?n:(t=["sport/cricket","sport/rugby-union","sport/rugbyleague","sport/formulaone","sport/tennis","sport/cycling","sport/motorsports","sport/golf","sport/horse-racing","sport/boxing","sport/us-sport","sport/australia-sport","football/championsleague","football/premierleague","football/championship","football/europeanfootball","football/world-cup-2014","football/manchester-united","football/chelsea","football/arsenal","football/manchestercity","football/tottenham-hotspur","football/liverpool"],e=n,S()(new Set(t)).filter(function(t){return new Set(e).has(t)}));return i.length?"/popular-in-tag/".concat(i[0],".json"):void 0}(),i=n?"related-popular-in-tag":"related-content",Object(I.a)(i),r.setAttribute("data-component",i),e=n||"/related/".concat(l.a.get("page.pageId"),".json");var c=t.excludeTags.map(function(t){return"exclude-tag=".concat(t)});t.excludeTags&&t.excludeTags.length&&(e+="?".concat(c.join("&"))),Object($.a)(e,{mode:"cors"}).then(function(t){return a.a.write(function(){r.innerHTML=t.html,r.classList.add("lazyloaded")})}).then(function(){var t=r.querySelector(".related-content");t&&B(t),O.a.emit("modules:related:loaded",r),Object(I.b)(i)}).catch(function(){r.remove(),Object(I.c)(i)})}}else Array.from(document.querySelectorAll(".js-related")).forEach(function(t){return t.classList.add("u-h")})}(t)})},dt=function(){ct(".js-onward",function(){(l.a.get("page.seriesId")||l.a.get("page.blogIds"))&&l.a.get("page.showRelatedContent")?new p.a(r()(".js-onward")):""!==l.a.get("page.tones","")&&a.a.read(function(){return Array.from(document.querySelectorAll(".js-onward"))}).then(function(t){t.forEach(function(t){(new H).fetch(t,"html")})})}),function(){var t=l.a.get("page.contentType","");if("Audio"===t||"Video"===t){var e=t.toLowerCase();Object(c.a)("video"===e?".js-video-components-container":".js-media-popular").each(function(t){!function(t,e){var n="video"===e?"append":"html",i=function(t){return Boolean(l.a.get("page.seriesTags"))?"/video/in-series/".concat(l.a.get("page.seriesId"),".json"):"/".concat(l.a.get("page.isPodcast")?"podcast":t,"/most-viewed.json")}(e);at(t,i,n).then(function(){!function(t,e,n){ot.a.on(t,"click",".most-viewed-navigation__button",function(i){var o=i.target.getAttribute("data-page");return at(t,n,e,o),i.preventDefault(),!1})}(t,n,i)})}(t,e)})}}(),"Audio"===l.a.get("page.contentType")&&Object(c.a)(".js-audio-components-container").each(function(t){return function(t){l.a.get("page.seriesId")&&function(t,e,n){var i=new C.a;i.manipulationType="append",i.endpoint="".concat(e,"?shortUrl=").concat(l.a.get("page.shortUrl")),t.innerHTML="",i.fetch(t,"html")}(t,"/audio/series/".concat(l.a.get("page.seriesId"),".json"))}(t)})},ht=function(){l.a.get("switches.enableDiscussionSwitch")&&l.a.get("page.commentable")&&a.a.read(function(){return document.querySelector(".discussion")}).then(function(t){t&&(new h.a).attachTo(t)})},ft=function(){Object(f.l)()||a.a.read(function(){return Object(c.a)(".js-comments")}).then(function(t){return a.a.write(function(){if(t.appendTo(r()(".js-repositioned-comments")),"#comments"===window.location.hash){var e=t.offset().top;Object(c.a)(document.body).scrollTop(e)}})})},pt=function(){Object(u.b)([["c-discussion",ht],["c-comments",ft],["c-shares",nt],["c-popular",lt],["c-related",ut],["c-onward",dt],["c-more-in-section",rt]])}},507:function(t,e,n){"use strict";var i=n(16),o=n.n(i),a=n(21),s=n.n(a),r=n(1),c=n.n(r),l=n(94),u=function(){function t(e){o()(this,t),c()(this,"context",void 0),c()(this,"states",void 0),c()(this,"debug",void 0),c()(this,"onChangeState",void 0),this.context=e.context,this.states=e.states||{},this.context.state=e.initial||"",this.debug=e.debug||!1,this.onChangeState=e.onChangeState.bind(this.context)||function(){}}return s()(t,[{key:"log",value:function(){var t;this.debug&&window.console&&window.console.log&&(t=window.console).log.apply(t,arguments)}},{key:"trigger",value:function(t,e){this.log("fsm: (event)",t);var n=this.context.state;(this.states[n].events[t]||l.a).call(this.context,e),(n!==this.context.state||this.context.reloadState)&&(this.context.reloadState=!1,this.onChangeState(n,this.context.state),(this.states[n].leave||l.a).apply(this.context),(this.states[this.context.state].enter||l.a).apply(this.context),this.log("fsm: (state)","".concat(n," -> ").concat(this.context.state)))}}]),t}();e.a=u},508:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var i=n(12),o=n.n(i),a=n(320),s=function(t){Object(a.a)("flashing-elements")?t&&t():o.a.write(function(){document.body&&document.body.classList.add("disable-flashing-elements"),t&&t()})}},512:function(t,e){t.exports='<div class="sharecount__heading"><%=icon%><span class="sharecount__text u-h">Shares</span></div>\n<div class="sharecount__value sharecount__value--full">0</div>\n<div class="sharecount__value sharecount__value--short">0</div>\n'},513:function(t,e){t.exports='<%= icon %><span class="sharecount__value sharecount__value--short">0</span> Shares\n'},522:function(t,e,n){"use strict";var i,o,a=n(566),s=n.n(a),r=n(8),c=n(157),l=n(508),u=n(529),d=n(3),h=function(){d.a.read(function(){return{lastModifiedElm:document.querySelector(".js-lm"),webPublicationDateElm:document.querySelector(".js-wpd")}}).then(function(t){var e=t.lastModifiedElm,n=t.webPublicationDateElm;e&&n&&(d.a.write(function(){n.classList.add("content__dateline-wpd--modified")}),n.addEventListener("click",function(){d.a.write(function(){e.classList.toggle("u-h")})}))})},f=n(23),p=n.n(f),g=n(567),m=n.n(g),b=n(0),v=n(6),y=n(7),w=n(319),x=n(55),j=n.n(x),k=Object(w.a)("shareTwitter",["icon","centered-icon"]),_=Object(w.a)("shareEmail",["icon","centered-icon"]),C='\n    <div class="selection-sharing">\n        <ul class="social u-unstyled u-cf" data-component="social-selection">\n            <li class="social__item" data-link-name="twitter">\n                <a  class="rounded-icon social-icon social-icon--twitter js-selection-twitter"\n                    data-link-name="social-selection"\n                    target="_blank"\n                    href="#">\n                    <span class="u-h">Share on Twitter</span>\n                    '.concat(k,'\n                </a>\n            </li>\n            <li class="social__item" data-link-name="email">\n                <a  class="rounded-icon social-icon social-icon--email js-selection-email"\n                    data-link-name="social-selection"\n                    target="_blank"\n                    href="#">\n                    <span class="u-h">Share via Email</span>\n                    ').concat(_,"\n                </a>\n            </li>\n        </ul>\n    </div>\n"),O=r.a.create(C),T=["js-article__body","content__standfirst","block","caption--main","content__headline"],E=function(){O.hasClass("selection-sharing--active")&&O.removeClass("selection-sharing--active")},S=function(){var t=window.getSelection&&document.createRange&&window.getSelection(),e=document.body;if(e&&t&&t.rangeCount>0&&t.toString()){var n=t.getRangeAt(0),a=m.a.getBoundingClientRect(n);if(!a)return;var s=Object(r.a)(e).scrollTop()+a.top,c=n.toString();if(!function(t){return T.some(function(e){return r.a.ancestor(t.startContainer,e)&&r.a.ancestor(t.endContainer,e)})}(n))return void E();c.length>252&&(c="".concat(c.slice(0,251),"…"));var l=encodeURIComponent(c),u="".concat(b.a.get("page.shortUrl"),"/stw"),d=encodeURI(u),h="https://twitter.com/intent/tweet?text=%E2%80%9C".concat(l,"%E2%80%9D&url=").concat(d),f=encodeURI(b.a.get("page.webTitle")),p=encodeURI(n.toString()),g="".concat(b.a.get("page.shortUrl"),"/sbl"),v=encodeURI(g),y="mailto:?subject=".concat(f,"&body=%E2%80%9C").concat(p,"%E2%80%9D ").concat(v);i.attr("href",h),o.attr("href",y),O.css({top:"".concat(s,"px"),left:"".concat(a.left,"px")}),O.hasClass("selection-sharing--active")||O.addClass("selection-sharing--active")}else E()},$=function(t){t.target.closest(".social__item")||E()},I=function(){document.body&&!Object(v.j)()&&(document.body.appendChild(O[0]),i=Object(r.a)(".js-selection-twitter"),o=Object(r.a)(".js-selection-email"),p.a.on(document.body,"keypress keydown keyup",j()(S,50)),p.a.on(document.body,"mouseup",j()(S,200)),p.a.on(document.body,"mousedown",j()($,50)),y.a.on("window:throttledResize",S))};n.d(e,"a",function(){return M});var L=function(){Object(r.a)(".fenced").each(s.a.render)},A=function(){Object(u.b)(),Object(u.a)()},M=function(){Object(c.b)([["trail-a11y",l.a],["trail-fence",L],["trail-twitter",A],["trail-sharing",I],["trail-last-modified",h]])}},528:function(t,e,n){"use strict";n.d(e,"b",function(){return b}),n.d(e,"a",function(){return m});var i=n(14),o=n.n(i),a=n(3),s=n(0),r=n(6),c=n(15),l=n(7),u=n(13),d=n(167),h=n(24),f=function(t,e){return a.a.write(function(){t.innerHTML=e.html,t.classList.remove("element-rich-link--not-upgraded"),t.classList.add("element-rich-link--upgraded"),Array.from(document.getElementsByClassName("submeta-container--break")).forEach(function(t){t.classList.remove("submeta-container--break")}),l.a.emit("rich-link:loaded",t)})},p=function(t){var e=t.querySelector("a");if(!e)return Promise.resolve();var n=e.href,i=s.a.get("page.host"),l=n.split(i),d=Object(r.m)({max:"mobileLandscape"});return l&&l[1]?Object(c.a)("/embed/card".concat(l[1],".json"),{mode:"cors"}).then(function(e){e.html&&(d?function(t){return a.a.read(function(){var e=t.getBoundingClientRect(),n=window.innerHeight||document.documentElement&&document.documentElement.clientHeight||0;return e.top>n})}(t).then(function(n){n&&f(t,e)}):f(t,e),function(t){h.a.adFree?a.a.write(function(){o()(t.children).filter(function(t){return t.classList.toString().includes("rich-link--paidfor")}).forEach(function(t){return t.classList.add("u-h")})}):Promise.resolve()}(t))}).catch(function(t){Object(u.a)(t,{feature:"rich-links"})}):Promise.resolve()},g=function(t){return t.includes(s.a.get("page.richLink"))},m=function(){var t,e=Array.from(document.querySelectorAll(".element-rich-link a")).map(function(t){return t.href}).some(g),n=s.a.get("page.shouldHideAdverts")||!s.a.get("page.showRelatedContent");return!s.a.get("page.richLink")||s.a.get("page.richLink").includes(s.a.get("page.pageId"))||n||e?Promise.resolve():d.a.fillSpace({bodySelector:".js-article__body",slotSelector:" > p",minAbove:200,minBelow:250,clearContentMeta:50,selectors:{" > h2":{minAbove:"mobile"===Object(r.d)()?20:0,minBelow:200}," > *:not(p):not(h2):not(blockquote)":{minAbove:35,minBelow:300}," .ad-slot":{minAbove:150,minBelow:200}," .element-rich-link":{minAbove:500,minBelow:500}," .element--showcase":{minAbove:["desktop","leftCol","wide"].includes(Object(r.d)())?200:0,minBelow:0}}},function(e){var n,i,o=(n={href:s.a.get("page.richLink")},'<aside class=" element element-rich-link element-rich-link--tag\n                    element--thumbnail element-rich-link--not-upgraded"\n            data-component="rich-link-tag"\n            data-link-name="rich-link-tag"\n            >\n        <p><a href="'.concat(i=n.href,'">').concat(i,"</a></p>\n    </aside>"));return e[0].insertAdjacentHTML("beforebegin",o),t=e[0].previousElementSibling}).then(function(e){if(e&&t)return p(t)})},b=function(){Array.from(document.getElementsByClassName("element-rich-link--not-upgraded")).forEach(p)}},529:function(t,e,n){"use strict";n.d(e,"b",function(){return h}),n.d(e,"a",function(){return d});var i=n(12),o=n.n(i),a=n(0),s=n(6),r=n(7),c=n(55),l=n.n(c),u=document.querySelector(".js-liveblog-body, .js-article__body, .js-article__body--minute-article"),d=function(){if(("mobile"!==Object(s.d)()||a.a.get("page.isMinuteArticle"))&&a.a.get("switches.enhanceTweets")){var t=Array.from(document.querySelectorAll("blockquote.js-tweet")),e=Object(s.g)().height;t.forEach(function(t){var n=t.getBoundingClientRect();2.5*e>n.top&&n.top+n.height>0&&o.a.write(function(){t.classList.remove("js-tweet"),t.classList.add("twitter-tweet"),function(){var t=Array.from(document.querySelectorAll("blockquote.twitter-tweet")),e=document.getElementById("twitter-widget");if(t.length){if(!e){var n=document.createElement("script"),i=document.scripts[0];n.id="twitter-widget",n.async=!0,n.src="//platform.twitter.com/widgets.js",i&&i.parentNode&&i.parentNode.insertBefore(n,i)}"undefined"!=typeof twttr&&twttr.widgets&&twttr.widgets.load&&twttr.widgets.load(u)}}()})})}},h=function(){r.a.on("window:throttledScroll",l()(d,200))}},568:function(t,e){t.exports='<details class="campaign campaign--snippet">\n\n    <summary class="campaign--snippet__header">\n        <div class="campaign--kicker">\n            <div class="campaign--snippet__heading-logo">\n                <div class="speech-bubble">\n                    <h4>Share your story</h4>\n                </div>\n            </div>\n            <div class="campaign--snippet__heading-text">\n                <h4 class="campaign--snippet__headline"> <%= data.title %></h4>\n                <%= data.description %>\n            </div>\n            <div class="success_box">\n                <p class="success-message">Thank you for your contribution</p>\n            </div>\n        </div>\n        <span class="campaign__button campaign__button--large campaign__button--rounded campaign--snippet__handle" aria-hidden="true">\n            <span class="is-off">\n                <svg class="icon icon--plus " viewBox="0 0 18 18">\n                    <path d="M8.2 0h1.6l.4 7.8 7.8.4v1.6l-7.8.4-.4 7.8H8.2l-.4-7.8L0 9.8V8.2l7.8-.4.4-7.8z"></path>\n                </svg>\n                    Tell us\n            </span>\n            <span class="is-on">\n                <svg class="icon icon--minus " viewBox="0 0 32 32">\n                    <rect x="5" y="15" width="22" height="3"></rect>\n                </svg>\n                  Hide\n            </span>\n        </span>\n    </summary>\n\n\n    <form action="/formstack-campaign/submit" method="post" class="campaign--snippet__body">\n\n        <input name="formId" type="hidden" value="<%=data.formId%>" />\n\n        <% data.formFields.forEach(function(field) { %>\n\n        <div class="form_input form_input--<%=field.type%>">\n            <div class="form_field">\n                <label for="<%=field.name%>"\n                       class="form_field_label <% if (field.required == \'1\') { %> required <% } %>" >\n                    <%= field.label %>\n                    <% if(field.description) { %>\n                        <span>(<%= field.description %>)</span>\n                    <% } %>\n                </label>\n\n                <% if(field.type === "textarea") { %>\n                <textarea name="field_<%=field.id%>"<% if (field.required == "1") { %> required <% } %>/></textarea>\n\n                <% } else if(field.type === "radio" || field.type === "checkbox") { %>\n                <div class="form_option_container">\n                <% field.options.forEach(function(option){ %>\n                    <input type="<%=field.type%>"\n                       value="<%=option.value%>"\n                       id="<%=option.label%>"\n                       name="field_<%=field.id%>"\n                    />\n                    <label for="<%=option.label%>">\n                        <%=option.value%>\n                    </label>\n                <% }) %>\n                </div>\n\n                <% } else if(field.type === "select") { %>\n                <select name="field_<%=field.id%>"\n                <% if (field.required == "1") { %> required <% } %>\n                >\n                <% field.options.forEach(function(option){ %>\n                <option value="<%=option.value%>">\n                    <%=option.value%>\n                </option>\n                <% }) %>\n\n                </select>\n\n                <% } else if(field.type === "file") { %>\n                <input name="field_<%=field.id%>"\n                       type="file"\n                       accept="image/*, .pdf"\n                <% if (field.required == "1") { %> required <% } %>\n                />\n                <p class="form-info-text">We accept images and pdfs. Maximum total file size: 6MB</p>\n\n                <% } else { %>\n                <input name="field_<%=field.id%>"\n                       type="<%=field.type%>"\n                <% if (field.required == "1") { %> required <% } %>\n                />\n                <% } %>\n            </div>\n\n        </div>\n\n        <% }) %>\n        <div class="form_input form_input--twitter-handle" aria-hidden="true">\n            <div class="form_field">\n                <input name="twitter-handle" type="text" id="twitter-handle" placeholder="@mytwitterhandle"/>\n            </div>\n        </div>\n        <div class="form_footer">\n            <div class="form_submit">\n                <button class="button button--rounded" type="submit">Share with the Guardian</button>\n            </div>\n            <div class="t_and_c">\n                <a href="https://www.theguardian.com/help/terms-of-service">Terms and conditions</a>\n            </div>\n        </div>\n        <div class="error_box"></div>\n\n    </form>\n\n</details>\n'},573:function(t,e){t.exports='<li class="<%=articleType%>-lightbox__item <%=articleType%>-lightbox__item--img js-<%=articleType%>-slide">\n    <div class="<%=articleType%>-lightbox__img-container"><img class="<%=articleType%>-lightbox__img js-<%=articleType%>-lightbox-img"></div>\n    <div class="<%=articleType%>-lightbox__info js-<%=articleType%>-lightbox-info">\n        <div class="<%=articleType%>-lightbox__progress <%=articleType%>-lightbox__progress--info">\n            <span class="<%=articleType%>-lightbox__index"><%=index%></span>\n            <span class="<%=articleType%>-lightbox__progress-separator"></span>\n            <span class="<%=articleType%>-lightbox__count"><%=count%></span>\n            </div>\n        <div class="<%=articleType%>-lightbox__img-caption"><%=caption%></div>\n        <div class="<%=articleType%>-lightbox__img-credit"><%=credit%></div>\n        <div class="block-share block-share--<%=articleType%>" data-link-name="block share">\n            <%=shareButtons%>\n        </div>\n</li>\n'},574:function(t,e){t.exports='<div class="gallery-lightbox__btn gallery-lightbox__btn--<%=label%> js-gallery-<%=label%>">\n<button data-link-name="gallery-lightbox <%=label%>" class="gallery-lightbox__btn-body"><i></i><%=label%></button>\n</div>'},575:function(t,e){t.exports='<li class="gallery-lightbox__item gallery-lightbox__item--endslate js-gallery-slide">\n<div class="gallery-lightbox__endslate js-gallery-endslate fc-container--media"></div>\n</li>'},576:function(t,e){t.exports='<div class="pamplemousse gallery-lightbox__loader js-loader">\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n<div class="pamplemousse__pip"><i></i></div>\n</div>'},577:function(t,e){t.exports='<a class="rounded-icon block-share__item block-share__item--<%=css%> js-blockshare-link" href="<%=url%>" target="_blank" data-link-name="social <%=css%>">\n    <span class="u-h"><%=text%></span>\n    <%= icon %>\n</a>\n'},661:function(t,e,n){"use strict";n.r(e),n.d(e,"init",function(){return Q}),n.d(e,"_",function(){return X});var i=n(28),o=n.n(i),a=n(1),s=n.n(a),r=n(16),c=n.n(r),l=n(21),u=n.n(l),d=n(78),h=n.n(d),f=n(75),p=n.n(f),g=n(79),m=n.n(g),b=n(23),v=n.n(b),y=n(11),w=n.n(y),x=n(22),j=n.n(x),k=n(8),_=n(0),C=n(6),O=n(507),T=n(7),E=n(59),S=n.n(E),$=n(261),I=n.n($),L=n(20),A=n(76),M=n(319),P=n(573),B=n.n(P),q=n(574),R=n.n(q),z=n(575),H=n.n(z),U=n(576),F=n.n(U),N=n(577),D=n.n(N),J=n(497),W=n(82),V=function(t){var e=w()(t);e.addClass("gallery-lightbox__button-pulse"),window.setTimeout(function(){e.removeClass("gallery-lightbox__button-pulse")},75)},K=function(t){function e(){return c()(this,e),h()(this,p()(e).apply(this,arguments))}return m()(e,t),u()(e,[{key:"prerender",value:function(){w()(this.elem).addClass(this.componentClass)}}]),e}(A.a),G=function(){function t(){var e=this;c()(this,t),s()(this,"showEndslate",void 0),s()(this,"useSwipe",void 0),s()(this,"swipeThreshold",void 0),s()(this,"lightboxEl",void 0),s()(this,"$lightboxEl",void 0),s()(this,"$indexEl",void 0),s()(this,"$countEl",void 0),s()(this,"$contentEl",void 0),s()(this,"nextBtn",void 0),s()(this,"prevBtn",void 0),s()(this,"closeBtn",void 0),s()(this,"infoBtn",void 0),s()(this,"$swipeContainer",void 0),s()(this,"resize",void 0),s()(this,"toggleInfo",void 0),s()(this,"fsm",void 0),s()(this,"states",void 0),s()(this,"images",void 0),s()(this,"swipeContainerWidth",void 0),s()(this,"$slides",void 0),s()(this,"index",void 0),s()(this,"$images",void 0),s()(this,"galleryJson",void 0),s()(this,"bodyScrollPosition",void 0),s()(this,"endslateEl",void 0),s()(this,"endslate",void 0),s()(this,"startIndex",void 0),s()(this,"endslate",new K),s()(this,"states",{closed:{enter:function(){this.hide()},leave:function(){this.show(),Object(L.g)({},document.title,"/".concat(this.galleryJson.id))},events:{open:function(){this.swipe&&this.swipe.slide(this.index,0),this.state="image"},loadJson:function(t){this.galleryJson=t,this.loadHtml(t),this.showEndslate&&this.loadEndslate(),this.$slides=Object(k.a)(".js-gallery-slide",this.$contentEl[0]),this.useSwipe&&this.initSwipe(),this.state="image"}}},image:{enter:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,this.useSwipe&&Object(C.m)({max:"tablet"})?100:0),Object(L.g)({},document.title,"/".concat(this.galleryJson.id,"#img-").concat(this.index),!0),v.a.on(this.$swipeContainer[0],"click",".js-gallery-content",this.toggleInfo),T.a.on("window:throttledResize",this.resize),this.$indexEl.text(this.index)},leave:function(){v.a.off(this.$swipeContainer[0],"click",this.toggleInfo),T.a.off("window:throttledResize",this.resize)},events:{next:function(){V(this.nextBtn),this.index===this.images.length?this.showEndslate?this.state="endslate":(this.index=1,this.reloadState=!0):(this.index+=1,this.reloadState=!0)},prev:function(){V(this.prevBtn),1===this.index?this.showEndslate?this.state="endslate":(this.index=this.images.length,this.reloadState=!0):(this.index-=1,this.reloadState=!0)},reload:function(){this.reloadState=!0},toggleInfo:function(){V(this.infoBtn),this.$lightboxEl.toggleClass("gallery-lightbox--show-info")},hideInfo:function(){V(this.infoBtn),this.$lightboxEl.removeClass("gallery-lightbox--show-info")},showInfo:function(){V(this.infoBtn),this.$lightboxEl.addClass("gallery-lightbox--show-info")},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.loadSurroundingImages(this.index,this.images.length),this.translateContent(this.index,0,0)},close:function(){this.state="closed"}}},endslate:{enter:function(){this.translateContent(this.$slides.length,0,0),this.index=this.images.length+1,T.a.on("window:throttledResize",this.resize)},leave:function(){T.a.off("window:throttledResize",this.resize)},events:{next:function(){V(this.nextBtn),this.index=1,this.state="image"},prev:function(){V(this.prevBtn),this.index=this.images.length,this.state="image"},reload:function(){this.reloadState=!0},resize:function(){this.swipeContainerWidth=this.$swipeContainer.dim().width,this.translateContent(this.$slides.length,0,0)},close:function(){this.state="closed"}}}}),this.showEndslate="mobile"!==Object(C.d)()&&"childrens-books-site"!==_.a.get("page.section")&&"Gallery"===_.a.get("page.contentType"),this.useSwipe=Object(C.j)(),this.swipeThreshold=.05;var n=function(t){var e=R.a;return S()(e)({label:t})},i='<div class="overlay gallery-lightbox gallery-lightbox--closed gallery-lightbox--hover">\n                <div class="gallery-lightbox__sidebar">\n                    '.concat(n("close"),'\n                    <div class="gallery-lightbox__progress  gallery-lightbox__progress--sidebar">\n                        <span class="gallery-lightbox__index js-gallery-index"></span>\n                        <span class="gallery-lightbox__progress-separator"></span>\n                        <span class="gallery-lightbox__count js-gallery-count"></span>\n                    </div>\n                    ').concat(n("next"),"\n                    ").concat(n("prev"),"\n                    ").concat(n("info-button"),'\n                </div>\n                <div class="js-gallery-swipe gallery-lightbox__swipe-container">\n                    <ul class="gallery-lightbox__content js-gallery-content"></ul>\n                </div>\n            </div>');this.lightboxEl=w.a.create(i),this.$lightboxEl=w()(this.lightboxEl).prependTo(document.body),this.$indexEl=Object(k.a)(".js-gallery-index",this.lightboxEl),this.$countEl=Object(k.a)(".js-gallery-count",this.lightboxEl),this.$contentEl=Object(k.a)(".js-gallery-content",this.lightboxEl),this.nextBtn=j()(".js-gallery-next",this.lightboxEl)[0],this.prevBtn=j()(".js-gallery-prev",this.lightboxEl)[0],this.closeBtn=j()(".js-gallery-close",this.lightboxEl)[0],this.infoBtn=j()(".js-gallery-info-button",this.lightboxEl)[0],this.$swipeContainer=Object(k.a)(".js-gallery-swipe"),v.a.on(this.nextBtn,"click",this.trigger.bind(this,"next")),v.a.on(this.prevBtn,"click",this.trigger.bind(this,"prev")),v.a.on(this.closeBtn,"click",this.close.bind(this)),v.a.on(this.infoBtn,"click",this.trigger.bind(this,"toggleInfo")),this.resize=this.trigger.bind(this,"resize"),this.toggleInfo=function(t){w()(t.target).hasClass("js-gallery-lightbox-info")||k.a.ancestor(t.target,"js-gallery-lightbox-info")||e.trigger("toggleInfo")},Object(C.j)()&&this.disableHover(),v.a.on(window,"popstate",function(t){t.state||e.trigger("close")}),this.fsm=new O.a({initial:"closed",onChangeState:function(t,e){this.$lightboxEl.removeClass("gallery-lightbox--".concat(t)).addClass("gallery-lightbox--".concat(e))},context:this,states:this.states})}return u()(t,[{key:"generateImgHTML",value:function(t,e){var n=_.a.get("page.shortUrl"),i=t.src.startsWith("//")?"http:":"",o=[{text:"Facebook",css:"facebook",icon:Object(M.a)("shareFacebook",["icon"]),url:"https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent("".concat(n,"/sfb#img-").concat(e)))},{text:"Twitter",css:"twitter",icon:Object(M.a)("shareTwitter",["icon"]),url:"https://twitter.com/intent/tweet?text=".concat(encodeURIComponent(_.a.get("page.webTitle")),"&url=").concat(encodeURIComponent("".concat(n,"/stw#img-").concat(e)))},{text:"Pinterest",css:"pinterest",icon:Object(M.a)("sharePinterest",["icon"]),url:encodeURI("http://www.pinterest.com/pin/create/button/?description=".concat(_.a.get("page.webTitle"),"&url=").concat(n,"&media=").concat(i).concat(t.src))}];return S()(B.a.replace(/^\s+|\s+$/gm,""))({articleType:"gallery",count:this.images.length,index:e,caption:t.caption,credit:t.displayCredit?t.credit:"",blockShortUrl:n,shareButtons:o.map(function(t){return S()(D.a)(t)}).join("")})}},{key:"initSwipe",value:function(){var t,e,n,i=this;v.a.on(this.$swipeContainer[0],"touchstart",function(o){t=i.swipeContainerWidth*i.swipeThreshold,e=o.touches[0].pageX,n=0}),v.a.on(this.$swipeContainer[0],"touchmove",I()(function(t){t.preventDefault(),t.touches.length>1||t.scale&&1!==t.scale||(n=t.touches[0].pageX-e,i.translateContent(i.index,n,20))},20,{trailing:!1})),v.a.on(this.$swipeContainer[0],"touchend",function(){var e;e=Math.abs(n)>t?n>t?1:-1:0,n=0,1===e?i.index>1?i.trigger("prev"):i.trigger("reload"):-1===e&&i.index<i.$slides.length?i.trigger("next"):i.trigger("reload")})}},{key:"disableHover",value:function(){this.$lightboxEl.removeClass("gallery-lightbox--hover")}},{key:"trigger",value:function(t,e){this.fsm.trigger(t,e)}},{key:"loadOrOpen",value:function(t,e){this.index=e,this.galleryJson&&t.id===this.galleryJson.id&&t.images.length===this.galleryJson.images.length?this.trigger("open"):this.trigger("loadJson",t)}},{key:"fetchSurroundingJson",value:function(e){var n=this;if("ImageContent"===_.a.get("page.contentType")&&e.images.length<2){var i=window.location.pathname.substring(1);return Promise.all([t.loadNextOrPrevious(i,"forwards"),t.loadNextOrPrevious(i,"backwards")]).then(function(t){var e=o()(t,2),n=e[0],i=e[1];return{next:n.map(function(t){return t.images[0]}),previous:i.map(function(t){return t.images[0]})}}).then(function(t){var i=t.next,o=t.previous,a=o.reverse().concat(e.images,i);return a.length<2&&(w()([n.nextBtn,n.prevBtn]).hide(),Object(k.a)(".gallery-lightbox__progress",n.lightboxEl).hide()),e.images=a,n.startIndex=o.length+1,e})}return Promise.resolve(e)}},{key:"loadHtml",value:function(t){var e=this;this.images=t.images||[];var n=t.images.map(function(t,n){return e.generateImgHTML(t,n+1)}).join("");this.$contentEl.html(n),this.$images=Object(k.a)(".js-gallery-lightbox-img",this.$contentEl[0]),this.$countEl.text(this.images.length)}},{key:"loadSurroundingImages",value:function(t,e){var n,i,o=this;[-1,0,1].map(function(n){return t+n===0?e-1:(t-1+n)%e}).forEach(function(t){n=o.images[t],(i=w()(o.$images[t])).attr("src")||(i.parent().append(w.a.create(F.a)),i.attr("src",n.src),i.attr("srcset",n.srcsets),i.attr("sizes",n.sizes),v.a.one(i[0],"load",function(){Object(k.a)(".js-loader").remove()}))})}},{key:"translateContent",value:function(t,e,n){var i=-1*(t-1)*this.swipeContainerWidth,o=this.$contentEl[0];Object.assign(o.style,{webkitTransitionDuration:"".concat(n,"ms"),mozTransitionDuration:"".concat(n,"ms"),msTransitionDuration:"".concat(n,"ms"),transitionDuration:"".concat(n,"ms"),webkitTransform:"translate(".concat(i+e,"px,0) translateZ(0)"),mozTransform:"translate(".concat(i+e,"px,0)"),msTransform:"translate(".concat(i+e,"px,0)"),transform:"translate(".concat(i+e,"px,0) translateZ(0)")})}},{key:"show",value:function(){var t=this,e=w()(document.body);this.bodyScrollPosition=e.scrollTop(),e.addClass("has-overlay"),this.$lightboxEl.addClass("gallery-lightbox--open"),v.a.off(document.body,"keydown",function(e){return t.handleKeyEvents(e)}),v.a.on(document.body,"keydown",function(e){return t.handleKeyEvents(e)})}},{key:"close",value:function(){L.i?Object(L.a)():this.trigger("close"),this.trigger("close")}},{key:"hide",value:function(){var t=this,e=w()(document.body);e.removeClass("has-overlay"),v.a.off(document.body,"keydown",this.handleKeyEvents),window.setTimeout(function(){t.bodyScrollPosition&&e.scrollTop(t.bodyScrollPosition),t.$lightboxEl.removeClass("gallery-lightbox--open"),T.a.emit("ui:images:vh")},1)}},{key:"handleKeyEvents",value:function(t){37===t.keyCode?this.trigger("prev"):39===t.keyCode?this.trigger("next"):38===t.keyCode?this.trigger("showInfo"):40===t.keyCode?this.trigger("hideInfo"):27===t.keyCode?this.close():73===t.keyCode&&this.trigger("toggleInfo")}},{key:"loadEndslate",value:function(){!this.endslate.rendered&&this.$contentEl&&(this.endslateEl=w.a.create(H.a),this.$contentEl.append(this.endslateEl),this.endslate.componentClass="gallery-lightbox__endslate",this.endslate.endpoint="/gallery/most-viewed.json",this.endslate.fetch(j()(".js-gallery-endslate",this.endslateEl),"html"))}}],[{key:"loadNextOrPrevious",value:function(t,e){var n="forwards"===e?"getnext":"getprev",i=_.a.get("page.nonKeywordTagIds","").split(",").filter(function(t){return t.includes("series")})[0],o="/".concat(n,"/").concat(i,"/").concat(t);return Object(W.a)(o).then(function(t){return t.json()}).then(function(t){return t.filter(function(t){return t.images.length>0})})}}]),t}(),Q=function(){J.a.then(function(){var t=_.a.get("page.lightboxImages");if(t&&t.images.length>0){var e=new G,n=window.location.hash;v.a.on(document.body,"click",".js-gallerythumbs",function(n){n.preventDefault();var i=w()(n.currentTarget),o=(i.attr("href")||i.attr("data-gallery-url")).split("#img-"),a=parseInt(o[1],10),s=Number.isNaN(a)?1:a;e.fetchSurroundingJson(t).then(function(t){var n=e.startIndex?e.startIndex:s;e.loadOrOpen(t,n)})});var i="/".concat(_.a.get("page.pageId")),o=/\?index=(\d+)/.exec(document.location.href),a=/^#(?:img-)?(\d+)$/.exec(n),s=0;o?(Object(L.g)({},document.title,i,!0),s=parseInt(o[1],10)):a&&(s=parseInt(a[1],10)),s>0&&e.fetchSurroundingJson(t).then(function(t){e.loadOrOpen(t,s)})}})},X={GalleryLightbox:G}},662:function(t,e,n){"use strict";n.r(e),n.d(e,"init",function(){return c});var i=n(22),o=n.n(i),a=n(0),s=n(76),r=n(495),c=function(){var t,e;Object(r.initTrails)(),a.a.get("page.showRelatedContent")&&(t=new s.a,e=o()(".js-gallery-most-popular")[0],t.manipulationType="html",t.endpoint="/gallery/most-viewed.json",t.fetch(e,"html"))}},672:function(t,e,n){"use strict";n.r(e);var i=n(0),o=n(22),a=n.n(o),s=n(8),r=n(157),c=n(6),l=n(7),u=n(20),d=n(528),h=n(12),f=n.n(h),p=n(15),g=n(13),m=function(t){var e=Object(s.a)("a",t).attr("href");e.match(/https:\/\/membership.theguardian.com/)&&Object(p.a)("".concat(e,"/card"),{mode:"cors"}).then(function(e){e.html&&f.a.write(function(){Object(s.a)(t).html(e.html).removeClass("element-membership--not-upgraded").addClass("element-membership--upgraded")})}).catch(function(t){Object(g.a)(t,{feature:"membership-events"})})},b=function(){Object(s.a)(".".concat("element-membership--not-upgraded")).each(m)},v=n(348),y=n(23),w=n.n(y),x=n(3),j=function(){if(HTMLFormElement.prototype.checkValidity){var t=Array.from(document.getElementsByClassName("js-atom-quiz--instant-reveal"));t.length&&w.a.on(document,"click",t,function t(e){var n=e.currentTarget,i=n.querySelectorAll(":checked + .atom-quiz__answer__item--is-correct").length;if(n.checkValidity()){var o=function(){var e=n.querySelector(".js-atom-quiz__bucket-message--".concat(i));if(e)return x.a.write(function(){e.style.display="block"}),w.a.off(document,"click",t),"break";i-=1};do{if("break"===o())break}while(i>=0)}})}},k=n(522),_=n(495),C=n(59),O=n.n(C),T=n(568),E=n.n(T),S=n(569),$=n.n(S),I=n(572),L=n.n(I),A=n(82),M=i.a.get("page.calloutsUrl"),P=function(t){return t.name>""},B=function(t){var e=t.closest(".element-campaign");x.a.write(function(){e.classList.add("success")})},q=function(t){var e=t.querySelector("button"),n=t.querySelector(".error_box");x.a.write(function(){e.textContent="Sending...",e.disabled=!0,n.innerHTML=""})},R=function(t,e){var n=t.querySelector(".error_box");n&&x.a.write(function(){n.innerHTML='<p class="error">'.concat(e,"</p>")}),function(t){var e=t.getElementsByTagName("button")[0];e.disabled=!1,e.textContent="Share with the Guardian"}(t)},z=function(t,e){if(function(t){return"checkbox"===t.type}(t))return(e[t.name]||"").concat("\n".concat(t.value));if(function(t){return"file"===t.type}(t)&&t.files[0]){var n=t.closest("form");return function(t,e){return new Promise(function(n){var i=new FileReader;i.addEventListener("load",function(){var t=i.result.toString().split(";base64,")[1];n(t)},!1),i.addEventListener("error",function(){R(e,"Sorry there was a problem with the file you uploaded above. Check the size and type. We only accept images, pdfs and .doc or .docx files")}),i.readAsDataURL(t)})}(t.files[0],n)}return t.value},H=function(){var t=L()($.a.mark(function t(e){var n,i;return $.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=e.target,t.next=4,o=n.elements,[].reduce.call(o,function(){var t=L()($.a.mark(function t(e,n){var i,o;return $.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(i=t.sent,!P(n)){t.next=9;break}return t.next=6,z(n,i);case 6:return o=t.sent,i[n.name]=o,t.abrupt("return",i);case 9:return t.abrupt("return",i);case 10:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),Promise.resolve({}));case 4:if(!((i=t.sent)["twitter-handle"].length>0)){t.next=8;break}return R(n,"Sorry we think you are a robot."),t.abrupt("return",!1);case 8:return q(n),t.abrupt("return",Object(A.a)(M,{method:"post",body:JSON.stringify(i),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){t.ok?B(n):R(n,"Sorry, there was a problem submitting your form. Please try again later.")}).catch(function(){console.error("Request to ".concat(M," failed")),R(n,"Sorry, there was a problem submitting your form. Please try again later.")}));case 10:case"end":return t.stop()}var o},t,this)}));return function(e){return t.apply(this,arguments)}}(),U=function(){var t,e=i.a.get("page.campaigns").filter(function(t){return"callout"===t.fields._type}).reduce(function(t,e){return t[e.fields.tagName]={name:e.name,title:e.fields.callout,description:e.fields.description||"",formFields:e.fields.formFields,formId:e.fields.formId,tagName:e.fields.tagName},t},{});(t=document.querySelectorAll("figure[data-alt]"),Array.from(t).filter(function(t){var e=t.getAttribute("data-alt");return!!e&&e.toLowerCase().startsWith("callout")})).forEach(function(t){var n=t.getAttribute("data-alt");if(n){var i=n.toLowerCase().split(" ")[1];i in e?function(t,e){var n=O()(E.a)({data:e}),i='<figure class="element element-campaign">'.concat(n,"</figure>");x.a.write(function(){t.innerHTML=i}).then(function(){var e=t.querySelector(".element-campaign .campaign .campaign--snippet__body");e&&e.addEventListener("submit",H)})}(t,e[i]):t.innerHTML=""}})},F=n(29),N=n.n(F);n.d(e,"init",function(){return J});var D={initCmpParam:function(){var t=Object(u.d)();t.CMP&&Object(s.a)(".element-pass-cmp").each(function(e){e.src="".concat(e.src,"?CMP=").concat(t.CMP)})},initRightHandComponent:function(){var t=a()(".js-content-main-column");!i.a.hasTone("Match reports")&&t[0]&&t[0].offsetHeight>1150&&Object(c.m)({min:"desktop"})?v.a.render():l.a.emit("modules:onward:geo-most-popular:cancel")},initQuizListeners:function(){l.a.on("quiz/ophan-event",N.a.record)},emitReadyEvent:function(){l.a.emit("page:article:ready")}},J=function(){Object(r.b)([["article-trails",_.initTrails],["article-liveblog-common",k.a],["article-righthand-component",D.initRightHandComponent],["article-cmp-param",D.initCmpParam],["article-quiz-listeners",D.initQuizListeners],["article-rich-links",d.b],["article-tag-rich-link",d.a],["article-upgrade-membership-events",b],["article-mediator-emit-event",D.emitReadyEvent],["article-handle-quiz-completion",j],["article-campaign",U]])}},674:function(t,e,n){"use strict";n.r(e);var i=n(0),o=n(6),a=n(7),s=n(528),r=n(16),c=n.n(r),l=n(21),u=n.n(l),d=n(1),h=n.n(d),f=n(11),p=n.n(f),g=n(3),m=function(){function t(e){var n=this;c()(this,t),h()(this,"affixed",void 0),h()(this,"$markerTop",void 0),h()(this,"$markerBottom",void 0),h()(this,"$container",void 0),h()(this,"$element",void 0),h()(this,"$window",void 0),window.addEventListener("click",function(){n.checkPosition()}),a.a.addListener("window:throttledScroll",function(){n.checkPosition()}),a.a.addListener("window:throttledResize",function(){n.calculateContainerPositioning()}),this.affixed=!1,this.$markerTop=p()(e.topMarker),this.$markerBottom=p()(e.bottomMarker),this.$container=p()(e.containerElement),this.$element=p()(e.element),this.$window=p()(document.body),this.checkPosition(),this.calculateContainerPositioning()}return u()(t,[{key:"calculateContainerPositioning",value:function(){var t=this;g.a.write(function(){t.$container.css("top","0")}).then(function(){return g.a.read(function(){return t.$markerTop.offset().top-t.$container.offset().top})}).then(function(e){g.a.write(function(){t.$container.css("top","".concat(e,"px"))})})}},{key:"checkPosition",value:function(){var t,e=this,n=this.$window.scrollTop(),i=this.$markerTop.offset().top,o=this.$markerBottom.offset().top,a=this.$element.dim().height,s=n>=i,r=n+a<o,c=a<p.a.viewport().height,l=r&&s&&c;if(this.affixed!==l){if(this.affixed=l,r)g.a.write(function(){e.$container.removeClass("affix-bottom")}),this.calculateContainerPositioning();else{var u=o-i-a+("auto"!==(t=this.$container.css("top"))?parseInt(t,10):0);g.a.write(function(){e.$container.css("top","".concat(u,"px")),e.$container.addClass("affix-bottom")})}g.a.write(function(){l?e.$element.addClass("affix"):e.$element.removeClass("affix")})}}}]),t}(),b=n(23),v=n.n(b),y=n(22),w=n.n(y),x=n(8),j=n(15),k=n(529),_=n(230),C=n(324),O=n(484),T=n(321),E=function(t){var e,n=Object.assign({toastOffsetTop:12,minUpdateDelay:1e3*(Object(o.m)({min:"desktop"})?10:30),maxUpdateDelay:12e5,backoffMultiplier:.75},t),i=Object(x.a)(".js-liveblog-body"),s=Object(x.a)(".toast__button"),r=Object(x.a)(".toast__text",s),c=w()(".toast__container")[0],l=n.minUpdateDelay,u=i.data("most-recent-block"),d=0,h=!window.location.search.includes("?page="),f=function(){g.a.write(function(){Object(x.a)(".autoupdate--hidden",i).addClass("autoupdate--highlight").removeClass("autoupdate--hidden"),a.a.emit("modules:autoupdate:unread",0)})},m=function(){g.a.write(function(){if(d>0){var t=d>1?" new updates":" new update";s.removeClass("toast__button--closed"),Object(x.a)(c).addClass("toast__container--open"),r.html(d+t)}else s.removeClass("loading").addClass("toast__button--closed"),Object(x.a)(c).removeClass("toast__container--open")})},b=function(){Object(o.p)()&&f(),d=0,m()},y=function t(){void 0!==e&&clearTimeout(e);var s=0,r="&isLivePage=".concat(h?"true":"false"),c="?lastUpdate=".concat(u||"block-0").concat(r),f="".concat(window.location.pathname,".json").concat(c),v=function(){var i,a;0===s||l>0?(i=l,a=Object(o.p)()?n.minUpdateDelay:Math.min(1.5*i,n.maxUpdateDelay),l=a,e=setTimeout(t,l)):e=setTimeout(t,1)};return Object(j.a)(f,{mode:"cors"}).then(function(t){var e,n,o;(s=t.numNewBlocks)>0&&(d+=s,a.a.emit("modules:autoupdate:unread",d),u=t.mostRecentBlockId,h?(e=t.html,o=x.a.create("<div>".concat(e,"</div>"))[0],g.a.write(function(){p()(o.children).addClass("autoupdate--hidden"),n=Array.from(o.children),i.prepend(n),a.a.emit("modules:autoupdate:updates",n.length),Object(O.a)(),Object(k.a)(),Object(T.a)(n)}),i.offset().top<window.pageYOffset?m():b()):m()),v()}).catch(function(){v()})};(function(){var t=document.title;a.a.on("modules:autoupdate:unread",function(e){!function(t,e){document.title=t>0?"(".concat(t,") ").concat(e):e}(e,t)})})(),new _.a(c,{top:n.toastOffsetTop,emitMessage:!0,containInParent:!1}).init(),y(),Object(o.k)(),v.a.on(document.body,"click",".toast__button",function(){h?g.a.read(function(){Object(C.b)(w()(".blocks")[0],300,"easeOutQuad"),g.a.write(function(){s.addClass("loading")}).then(function(){b()})}):window.location.assign(window.location.pathname)}),a.a.on("modules:toast__tofix:unfixed",function(){h&&d>0&&g.a.write(function(){s.addClass("loading")}).then(function(){b()})}),a.a.on("modules:detect:pagevisibility:visible",function(){0===d&&f(),l=0,y()}),g.a.write(function(){i.addClass("autoupdate--has-animation")})},S=n(522),$=n(495),I=n(157);n.d(e,"init",function(){return P});var L=function(){var t=i.a.get("page.keywordIds","");!Object(o.m)({min:"desktop"})||t.includes("football/football")||t.includes("sport/rugby-union")||new m({element:document.querySelector(".js-live-blog__sticky-components-container"),topMarker:document.querySelector(".js-top-marker"),bottomMarker:document.querySelector(".js-bottom-marker"),containerElement:document.querySelector(".js-live-blog__sticky-components")})},A=function(){i.a.get("page.isLive")&&E()},M=function(){window.setInterval(function(){return Object(O.a)()},6e4)},P=function(){Object(I.b)([["lb-autoupdate",A],["lb-timeline",L],["lb-timestamp",M],["lb-richlinks",s.b]]),Object($.initTrails)(),Object(S.a)(),Object(I.b)([["lb-ready",function(){a.a.emit("page:liveblog:ready")}]])}},678:function(t,e,n){"use strict";n.r(e);var i=n(522),o=n(495),a=n(8),s=n(3),r=n(7),c=n(6),l=function(t){t.elements.forEach(function(e){!function(t){s.a.write(function(){t.$el.css("height","")}).then(function(){if(t.isMobile)return s.a.read(function(){return t.$el.height()}).then(function(e){return s.a.write(function(){t.$el.css("height",e)})})})}({$el:Object(a.a)(e),isMobile:t.isMobile})})},u=function(){s.a.read(function(){return{elements:Array.from(document.getElementsByClassName("js-is-fixed-height")),isMobile:"mobile"===Object(c.d)()}}).then(l)};n.d(e,"init",function(){return d});var d=function(){Object(i.a)(),Object(o.initTrails)(),r.a.on("window:throttledResize",u),r.a.on("window:orientationchange",u),u()}}}]);
//# sourceMappingURL=graun.article.js.map